import csv
import sys

def find_permissive_rules(csv_file_path):
    permissive_rules = []

    with open(csv_file_path, 'r') as file:
        reader = csv.reader(file)
        headers = next(reader)  # Skip the header row

        for row in reader:
            from_zone, to_zone, rule_name, src_addr, dst_addr, app, dyn_app, action = row
            if src_addr.lower() == 'any' or dst_addr.lower() == 'any' or app.lower() == 'any':
                permissive_rules.append(row)

    return permissive_rules

def write_permissive_rules(permissive_rules, output_file_path):
    with open(output_file_path, 'w', newline='') as file:
        writer = csv.writer(file)
        writer.writerow(["From Zone", "To Zone", "Rule Name", "Source Address", "Destination Address", "Application", "Dynamic Application", "Action"])
        writer.writerows(permissive_rules)

# Main execution
if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python3 find_permissive_rules.py <input_csvfile> <output_csvfile>")
        sys.exit(1)
    
    input_csv_file_path = sys.argv[1]
    output_csv_file_path = sys.argv[2]

    permissive_rules = find_permissive_rules(input_csv_file_path)
    write_permissive_rules(permissive_rules, output_csv_file_path)