#!/bin/bash

# Check if the user has provided an input file
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 ip_list.txt"
    exit 1
fi

# Assign the first argument to the variable 'file'
file=$1

# Check if the file exists
if [ ! -f "$file" ]; then
    echo "File not found!"
    exit 1
fi

# Read the file line by line
while IFS= read -r ip
do
    # Skip empty lines
    if [ -z "$ip" ]; then
        continue
    fi

    # Replace dots in IP address with underscores for the filename
    filename=$(echo "$ip" | tr '.' '_')

    # Perform nmap scan on all TCP ports for the given IP
    echo "Scanning IP: $ip"
    nmap -sU --top-ports 200 -v10 -oA  "output_$filename" "$ip"
done < "$file"

echo "Nmap scan completed. Results saved to individual output files."