#!/bin/bash

# Check if a file path is provided
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <file>"
    exit 1
fi

input_file=$1

# Check if the file exists
if [ ! -f "$input_file" ]; then
    echo "Error: File does not exist."
    exit 1
fi

echo "| CVE Numbers |"
echo "|-------------|"

# Extract CVE numbers and format them into a markdown table
grep -o 'CVE-[0-9]\{4\}-[0-9]\{4,7\}' "$input_file" | awk '{print "| "$0" |"}'
